[
  {
    "AccountId": "471112513806",
    "Arn": "arn:aws:guardduty:eu-west-2:471112513806:detector/c2c80de2aad70b707d9229d64be4bb1e/finding/03c0239411a844deaa14f327320611b4",
    "CreatedAt": "2024-06-15T12:03:59.046Z",
    "Description": "The S3 API GeneratedFindingAPIName was invoked from known malicious IP address 198.51.100.0. This can indicate an attempt by an adversary to tamper with data in your AWS environment.",
    "Id": "03c0239411a844deaa14f327320611b4",
    "Partition": "aws",
    "Region": "eu-west-2",
    "Resource": {
      "AccessKeyDetails": {
        "AccessKeyId": "GeneratedFindingAccessKeyId",
        "PrincipalId": "GeneratedFindingPrincipalId",
        "UserName": "GeneratedFindingUserName",
        "UserType": "IAMUser"
      },
      "S3BucketDetails": [
        {
          "Arn": "arn:aws:s3:::EXAMPLE-BUCKET1",
          "Name": "EXAMPLE-BUCKET1",
          "Type": "Destination",
          "CreatedAt": "2017-12-18T15:58:11.551Z",
          "Owner": {
            "Id": "1234567890abcdefghijklmnopqrstuvwxyz1234567891234567891234567891"
          },
          "Tags": [
            {
              "Key": "GeneratedFindingS3Tag1",
              "Value": "GeneratedFindingS3TagValue1"
            },
            {
              "Key": "GeneratedFindingS3Tag2",
              "Value": "GeneratedFindingS3TagValue2"
            },
            {
              "Key": "GeneratedFindingS3Tag3",
              "Value": "GeneratedFindingS3TagValue3"
            },
            {
              "Key": "GeneratedFindingS3Tag4",
              "Value": "bGeneratedFindingS3TagValue4"
            }
          ],
          "DefaultServerSideEncryption": {
            "EncryptionType": "SSEAlgorithm",
            "KmsMasterKeyArn": "arn:aws:kms:us-west-2:123456789012:key/abcdef123-4567-8901-2345-67890abcdef1"
          },
          "PublicAccess": {
            "PermissionConfiguration": {
              "BucketLevelPermissions": {
                "AccessControlList": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BucketPolicy": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              },
              "AccountLevelPermissions": {
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              }
            },
            "EffectivePermission": "NOT_PUBLIC"
          }
        },
        {
          "Arn": "arn:aws:s3:::EXAMPLE-BUCKET2",
          "Name": "EXAMPLE-BUCKET2",
          "Type": "Destination",
          "CreatedAt": "2017-12-18T15:58:11.551Z",
          "Owner": {
            "Id": "1234567890abcdefghijklmnopqrstuvwxyz1234567891234567891234567892"
          },
          "Tags": [
            {
              "Key": "GeneratedFindingS3Tag1",
              "Value": "GeneratedFindingS3TagValue1"
            },
            {
              "Key": "GeneratedFindingS3Tag2",
              "Value": "GeneratedFindingS3TagValue2"
            },
            {
              "Key": "GeneratedFindingS3Tag3",
              "Value": "GeneratedFindingS3TagValue3"
            },
            {
              "Key": "GeneratedFindingS3Tag4",
              "Value": "bGeneratedFindingS3TagValue4"
            }
          ],
          "DefaultServerSideEncryption": {
            "EncryptionType": "SSEAlgorithm",
            "KmsMasterKeyArn": "arn:aws:kms:us-west-2:123456789012:key/abcdef123-4567-8901-2345-67890abcdef2"
          },
          "PublicAccess": {
            "PermissionConfiguration": {
              "BucketLevelPermissions": {
                "AccessControlList": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BucketPolicy": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              },
              "AccountLevelPermissions": {
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              }
            },
            "EffectivePermission": "NOT_PUBLIC"
          }
        },
        {
          "Arn": "arn:aws:s3:::EXAMPLE-BUCKET3",
          "Name": "EXAMPLE-BUCKET3",
          "Type": "Destination",
          "CreatedAt": "2017-12-18T15:58:11.551Z",
          "Owner": {
            "Id": "1234567890abcdefghijklmnopqrstuvwxyz1234567891234567891234567893"
          },
          "Tags": [
            {
              "Key": "GeneratedFindingS3Tag1",
              "Value": "GeneratedFindingS3TagValue1"
            },
            {
              "Key": "GeneratedFindingS3Tag2",
              "Value": "GeneratedFindingS3TagValue2"
            },
            {
              "Key": "GeneratedFindingS3Tag3",
              "Value": "GeneratedFindingS3TagValue3"
            },
            {
              "Key": "GeneratedFindingS3Tag4",
              "Value": "bGeneratedFindingS3TagValue4"
            }
          ],
          "DefaultServerSideEncryption": {
            "EncryptionType": "SSEAlgorithm",
            "KmsMasterKeyArn": "arn:aws:kms:us-west-2:123456789012:key/abcdef123-4567-8901-2345-67890abcdef3"
          },
          "PublicAccess": {
            "PermissionConfiguration": {
              "BucketLevelPermissions": {
                "AccessControlList": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BucketPolicy": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              },
              "AccountLevelPermissions": {
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              }
            },
            "EffectivePermission": "NOT_PUBLIC"
          }
        },
        {
          "Arn": "arn:aws:s3:::EXAMPLE-BUCKET4",
          "Name": "EXAMPLE-BUCKET4",
          "Type": "Destination",
          "CreatedAt": "2017-12-18T15:58:11.551Z",
          "Owner": {
            "Id": "1234567890abcdefghijklmnopqrstuvwxyz1234567891234567891234567894"
          },
          "Tags": [
            {
              "Key": "GeneratedFindingS3Tag1",
              "Value": "GeneratedFindingS3TagValue1"
            },
            {
              "Key": "GeneratedFindingS3Tag2",
              "Value": "GeneratedFindingS3TagValue2"
            },
            {
              "Key": "GeneratedFindingS3Tag3",
              "Value": "GeneratedFindingS3TagValue3"
            },
            {
              "Key": "GeneratedFindingS3Tag4",
              "Value": "bGeneratedFindingS3TagValue4"
            }
          ],
          "DefaultServerSideEncryption": {
            "EncryptionType": "SSEAlgorithm",
            "KmsMasterKeyArn": "arn:aws:kms:us-west-2:123456789012:key/abcdef123-4567-8901-2345-67890abcdef4"
          },
          "PublicAccess": {
            "PermissionConfiguration": {
              "BucketLevelPermissions": {
                "AccessControlList": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BucketPolicy": {
                  "AllowsPublicReadAccess": false,
                  "AllowsPublicWriteAccess": false
                },
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              },
              "AccountLevelPermissions": {
                "BlockPublicAccess": {
                  "IgnorePublicAcls": false,
                  "RestrictPublicBuckets": false,
                  "BlockPublicAcls": false,
                  "BlockPublicPolicy": false
                }
              }
            },
            "EffectivePermission": "NOT_PUBLIC"
          }
        }
      ],
      "InstanceDetails": {
        "AvailabilityZone": "GeneratedFindingInstaceAvailabilityZone",
        "IamInstanceProfile": {
          "Arn": "arn:aws:iam::471112513806:example/instance/profile",
          "Id": "GeneratedFindingInstanceProfileId"
        },
        "ImageDescription": "GeneratedFindingInstaceImageDescription",
        "ImageId": "ami-99999999",
        "InstanceId": "i-99999999",
        "InstanceState": "running",
        "InstanceType": "m3.xlarge",
        "OutpostArn": "arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3",
        "LaunchTime": "2016-08-02T02:05:06.000Z",
        "NetworkInterfaces": [
          {
            "Ipv6Addresses": [],
            "NetworkInterfaceId": "eni-abcdef00",
            "PrivateDnsName": "GeneratedFindingPrivateDnsName1",
            "PrivateIpAddress": "10.0.0.1",
            "PrivateIpAddresses": [
              {
                "PrivateDnsName": "GeneratedFindingPrivateName1",
                "PrivateIpAddress": "10.0.0.1"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName2",
                "PrivateIpAddress": "10.0.0.2"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName3",
                "PrivateIpAddress": "10.0.0.3"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName4",
                "PrivateIpAddress": "10.0.0.4"
              }
            ],
            "PublicDnsName": "GeneratedFindingPublicDNSName1",
            "PublicIp": "198.51.100.1",
            "SecurityGroups": [
              {
                "GroupId": "GeneratedFindingSecurityId1",
                "GroupName": "GeneratedFindingSecurityGroupName1"
              },
              {
                "GroupId": "GeneratedFindingSecurityId2",
                "GroupName": "GeneratedFindingSecurityGroupName2"
              },
              {
                "GroupId": "GeneratedFindingSecurityId3",
                "GroupName": "GeneratedFindingSecurityGroupName3"
              },
              {
                "GroupId": "GeneratedFindingSecurityId4",
                "GroupName": "GeneratedFindingSecurityGroupName4"
              }
            ],
            "SubnetId": "GeneratedFindingSubnetId1",
            "VpcId": "GeneratedFindingVPCId1"
          },
          {
            "Ipv6Addresses": [],
            "NetworkInterfaceId": "eni-abcdef01",
            "PrivateDnsName": "GeneratedFindingPrivateDnsName2",
            "PrivateIpAddress": "10.0.0.2",
            "PrivateIpAddresses": [
              {
                "PrivateDnsName": "GeneratedFindingPrivateName1",
                "PrivateIpAddress": "10.0.0.1"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName2",
                "PrivateIpAddress": "10.0.0.2"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName3",
                "PrivateIpAddress": "10.0.0.3"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName4",
                "PrivateIpAddress": "10.0.0.4"
              }
            ],
            "PublicDnsName": "GeneratedFindingPublicDNSName2",
            "PublicIp": "198.51.100.2",
            "SecurityGroups": [
              {
                "GroupId": "GeneratedFindingSecurityId1",
                "GroupName": "GeneratedFindingSecurityGroupName1"
              },
              {
                "GroupId": "GeneratedFindingSecurityId2",
                "GroupName": "GeneratedFindingSecurityGroupName2"
              },
              {
                "GroupId": "GeneratedFindingSecurityId3",
                "GroupName": "GeneratedFindingSecurityGroupName3"
              },
              {
                "GroupId": "GeneratedFindingSecurityId4",
                "GroupName": "GeneratedFindingSecurityGroupName4"
              }
            ],
            "SubnetId": "GeneratedFindingSubnetId2",
            "VpcId": "GeneratedFindingVPCId2"
          },
          {
            "Ipv6Addresses": [],
            "NetworkInterfaceId": "eni-abcdef02",
            "PrivateDnsName": "GeneratedFindingPrivateDnsName3",
            "PrivateIpAddress": "10.0.0.3",
            "PrivateIpAddresses": [
              {
                "PrivateDnsName": "GeneratedFindingPrivateName1",
                "PrivateIpAddress": "10.0.0.1"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName2",
                "PrivateIpAddress": "10.0.0.2"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName3",
                "PrivateIpAddress": "10.0.0.3"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName4",
                "PrivateIpAddress": "10.0.0.4"
              }
            ],
            "PublicDnsName": "GeneratedFindingPublicDNSName3",
            "PublicIp": "198.51.100.3",
            "SecurityGroups": [
              {
                "GroupId": "GeneratedFindingSecurityId1",
                "GroupName": "GeneratedFindingSecurityGroupName1"
              },
              {
                "GroupId": "GeneratedFindingSecurityId2",
                "GroupName": "GeneratedFindingSecurityGroupName2"
              },
              {
                "GroupId": "GeneratedFindingSecurityId3",
                "GroupName": "GeneratedFindingSecurityGroupName3"
              },
              {
                "GroupId": "GeneratedFindingSecurityId4",
                "GroupName": "GeneratedFindingSecurityGroupName4"
              }
            ],
            "SubnetId": "GeneratedFindingSubnetId3",
            "VpcId": "GeneratedFindingVPCId3"
          },
          {
            "Ipv6Addresses": [],
            "NetworkInterfaceId": "eni-abcdef03",
            "PrivateDnsName": "GeneratedFindingPrivateDnsName4",
            "PrivateIpAddress": "10.0.0.4",
            "PrivateIpAddresses": [
              {
                "PrivateDnsName": "GeneratedFindingPrivateName1",
                "PrivateIpAddress": "10.0.0.1"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName2",
                "PrivateIpAddress": "10.0.0.2"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName3",
                "PrivateIpAddress": "10.0.0.3"
              },
              {
                "PrivateDnsName": "GeneratedFindingPrivateName4",
                "PrivateIpAddress": "10.0.0.4"
              }
            ],
            "PublicDnsName": "GeneratedFindingPublicDNSName4",
            "PublicIp": "198.51.100.4",
            "SecurityGroups": [
              {
                "GroupId": "GeneratedFindingSecurityId1",
                "GroupName": "GeneratedFindingSecurityGroupName1"
              },
              {
                "GroupId": "GeneratedFindingSecurityId2",
                "GroupName": "GeneratedFindingSecurityGroupName2"
              },
              {
                "GroupId": "GeneratedFindingSecurityId3",
                "GroupName": "GeneratedFindingSecurityGroupName3"
              },
              {
                "GroupId": "GeneratedFindingSecurityId4",
                "GroupName": "GeneratedFindingSecurityGroupName4"
              }
            ],
            "SubnetId": "GeneratedFindingSubnetId4",
            "VpcId": "GeneratedFindingVPCId4"
          }
        ],
        "Platform": null,
        "ProductCodes": [
          {
            "Code": "GeneratedFindingProductCodeId1",
            "ProductType": "GeneratedFindingProductCodeType1"
          },
          {
            "Code": "GeneratedFindingProductCodeId2",
            "ProductType": "GeneratedFindingProductCodeType2"
          },
          {
            "Code": "GeneratedFindingProductCodeId3",
            "ProductType": "GeneratedFindingProductCodeType3"
          },
          {
            "Code": "GeneratedFindingProductCodeId4",
            "ProductType": "GeneratedFindingProductCodeType4"
          },
          {
            "Code": "GeneratedFindingProductCodeId5",
            "ProductType": "GeneratedFindingProductCodeType5"
          }
        ],
        "Tags": [
          {
            "Key": "GeneratedFindingInstaceTag1",
            "Value": "GeneratedFindingInstaceValue1"
          },
          {
            "Key": "GeneratedFindingInstaceTag2",
            "Value": "GeneratedFindingInstaceTagValue2"
          },
          {
            "Key": "GeneratedFindingInstaceTag3",
            "Value": "GeneratedFindingInstaceTagValue3"
          },
          {
            "Key": "GeneratedFindingInstaceTag4",
            "Value": "GeneratedFindingInstaceTagValue4"
          },
          {
            "Key": "GeneratedFindingInstaceTag5",
            "Value": "GeneratedFindingInstaceTagValue5"
          },
          {
            "Key": "GeneratedFindingInstaceTag6",
            "Value": "GeneratedFindingInstaceTagValue6"
          },
          {
            "Key": "GeneratedFindingInstaceTag7",
            "Value": "GeneratedFindingInstaceTagValue7"
          },
          {
            "Key": "GeneratedFindingInstaceTag8",
            "Value": "GeneratedFindingInstaceTagValue8"
          },
          {
            "Key": "GeneratedFindingInstaceTag9",
            "Value": "GeneratedFindingInstaceTagValue9"
          }
        ]
      },
      "ResourceType": "S3Bucket"
    },
    "SchemaVersion": "2.0",
    "Service": {
      "Action": {
        "ActionType": "AWS_API_CALL",
        "AwsApiCallAction": {
          "Api": "GeneratedFindingAPIName",
          "CallerType": "Remote IP",
          "ErrorCode": "AccessDenied",
          "RemoteIpDetails": {
            "City": {
              "CityName": "GeneratedFindingCityName"
            },
            "Country": {
              "CountryName": "GeneratedFindingCountryName"
            },
            "GeoLocation": {
              "Lat": 0,
              "Lon": 0
            },
            "IpAddressV4": "198.51.100.0",
            "IpAddressV6": "1234:5678:90ab:cdef:1234:5678:90ab:cde0",
            "Organization": {
              "Asn": "-1",
              "AsnOrg": "GeneratedFindingASNOrg",
              "Isp": "GeneratedFindingISP",
              "Org": "GeneratedFindingORG"
            }
          },
          "ServiceName": "GeneratedFindingAPIServiceName",
          "AffectedResources": {
            "AWS::S3::Bucket": "GeneratedFindingS3Bucket"
          }
        }
      },
      "Archived": false,
      "Count": 1,
      "DetectorId": "c2c80de2aad70b707d9229d64be4bb1e",
      "EventFirstSeen": "2024-06-15T12:03:59.000Z",
      "EventLastSeen": "2024-06-15T12:03:59.000Z",
      "ResourceRole": "TARGET",
      "ServiceName": "guardduty",
      "AdditionalInfo": {
        "Value": "{\"sample\":true}",
        "Type": "default"
      }
    },
    "Severity": 8,
    "Title": "The S3 API GeneratedFindingAPIName was invoked from known malicious IP address 198.51.100.0.",
    "Type": "Impact:S3/MaliciousIPCaller",
    "UpdatedAt": "2024-06-15T12:03:59.046Z"
  }
]
